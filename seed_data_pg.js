// seed_data_pg.js — Populate lab catalog, radiology catalog, medical services, sample drugs & patients
const { pool } = require('./db_postgres');

async function insertSampleData() {
    const res = await pool.query("SELECT setting_value FROM company_settings WHERE setting_key='sample_data_inserted'");
    if (res.rows.length && res.rows[0].setting_value === '1') return;
    const pc = await pool.query('SELECT COUNT(*) as cnt FROM patients');
    if (parseInt(pc.rows[0].cnt) > 0) {
        await pool.query("UPDATE company_settings SET setting_value='1' WHERE setting_key='sample_data_inserted'");
        return;
    }
    // Patients
    await pool.query(`INSERT INTO patients (file_number,name_ar,name_en,national_id,phone,status) VALUES (1001,'أحمد محمد','Ahmed Mohammed','1012345678','0551234567','With Doctor'),(1002,'سارة عبدالرحمن','Sarah Abdulrahman','1098765432','0559876543','Waiting'),(1003,'فيصل العتيبي','Faisal Al-Otaibi','1054321098','0553456789','Waiting')`);
    // Employees
    await pool.query(`INSERT INTO employees (name,name_ar,name_en,role,department_ar,department_en,status,salary) VALUES ('Dr. Khaled Marwan','د. خالد مروان','Dr. Khaled Marwan','Doctor','القسم الطبي','Medical Dept.','Active',25000),('Sarah Al-Ahmad','سارة الأحمد','Sarah Al-Ahmad','Nurse','التمريض','Nursing','Active',12000),('Omar Saleh','عمر صالح','Omar Saleh','Admin','تقنية المعلومات','IT Dept.','On Leave',9500)`);
    // Invoices
    await pool.query(`INSERT INTO invoices (patient_name,total,paid) VALUES ('Ahmed Mohammed',575.00,1),('Yasser Khaled',1240.00,0),('Sarah Ali',890.50,1)`);
    // Insurance claims
    await pool.query(`INSERT INTO insurance_claims (patient_name,insurance_company,claim_amount,status) VALUES ('Ahmed Mohammed','Bupa Arabia',2500.00,'Approved'),('Yasser Khaled','Tawuniya',4200.00,'Pending'),('Sarah Ali','MedGulf',1800.00,'Rejected')`);
    await pool.query("UPDATE company_settings SET setting_value='1' WHERE setting_key='sample_data_inserted'");
    console.log('  ✅ Sample data inserted');
}

async function populateLabCatalog() {
    const r = await pool.query('SELECT COUNT(*) as cnt FROM lab_tests_catalog');
    if (parseInt(r.rows[0].cnt) > 0) return;
    const tests = [
        ['CBC - Complete Blood Count', 'Hematology', 'See components', 100], ['WBC - White Blood Cell Count', 'Hematology', '4.5-11.0 x10^9/L', 50], ['RBC - Red Blood Cell Count', 'Hematology', 'M:4.7-6.1 F:4.2-5.4 x10^12/L', 50], ['Hemoglobin (Hgb)', 'Hematology', 'M:13.5-17.5 F:12.0-16.0 g/dL', 50], ['Hematocrit (Hct)', 'Hematology', 'M:38.3-48.6% F:35.5-44.9%', 50], ['MCV - Mean Corpuscular Volume', 'Hematology', '80-100 fL', 40], ['MCH - Mean Corpuscular Hemoglobin', 'Hematology', '27-33 pg', 40], ['MCHC', 'Hematology', '31.5-35.7 g/dL', 40], ['RDW - Red Cell Distribution Width', 'Hematology', '11.5-14.5%', 40], ['Platelet Count', 'Hematology', '150-400 x10^9/L', 50], ['MPV - Mean Platelet Volume', 'Hematology', '7.5-11.5 fL', 40], ['ESR - Erythrocyte Sedimentation Rate', 'Hematology', 'M:0-15 F:0-20 mm/hr', 60], ['Reticulocyte Count', 'Hematology', '0.5-2.5%', 80], ['Peripheral Blood Smear', 'Hematology', 'Normal morphology', 120], ['Hemoglobin Electrophoresis', 'Hematology', 'HbA >95%', 200], ['G6PD', 'Hematology', '4.6-13.5 U/g Hb', 150], ['Sickle Cell Screen', 'Hematology', 'Negative', 100], ['Direct Coombs Test (DAT)', 'Hematology', 'Negative', 100], ['Indirect Coombs Test (IAT)', 'Hematology', 'Negative', 100], ['Haptoglobin', 'Hematology', '30-200 mg/dL', 120], ['CD4 Count (Flow Cytometry)', 'Hematology', '500-1500 cells/uL', 250], ['CD8 Count (Flow Cytometry)', 'Hematology', '150-1000 cells/uL', 250],
        ['PT - Prothrombin Time', 'Coagulation', '11.0-13.5 seconds', 80], ['INR', 'Coagulation', '0.8-1.1', 80], ['aPTT', 'Coagulation', '25-35 seconds', 80], ['D-Dimer', 'Coagulation', '<0.50 mg/L FEU', 120], ['Fibrinogen', 'Coagulation', '200-400 mg/dL', 100], ['Thrombin Time', 'Coagulation', '14-19 seconds', 100], ['Bleeding Time', 'Coagulation', '2-7 minutes', 60], ['Factor V Leiden Mutation', 'Coagulation', 'Not detected', 300], ['Protein C Activity', 'Coagulation', '70-140%', 250], ['Protein S Activity', 'Coagulation', '60-140%', 250], ['Antithrombin III', 'Coagulation', '80-120%', 200], ['Lupus Anticoagulant', 'Coagulation', 'Negative', 200], ['von Willebrand Factor Antigen', 'Coagulation', '50-150%', 250],
        ['Glucose, Fasting', 'Chemistry', '70-100 mg/dL', 50], ['Glucose, Random', 'Chemistry', '70-140 mg/dL', 50], ['Glucose, 2-Hour Postprandial', 'Chemistry', '<140 mg/dL', 60], ['Oral Glucose Tolerance Test (OGTT)', 'Chemistry', '<140 mg/dL at 2hr', 120], ['BUN - Blood Urea Nitrogen', 'Chemistry', '7-20 mg/dL', 50], ['Creatinine, Serum', 'Chemistry', 'M:0.7-1.3 F:0.6-1.1 mg/dL', 50], ['eGFR', 'Chemistry', '>60 mL/min/1.73m2', 50], ['Uric Acid', 'Chemistry', 'M:3.4-7.0 F:2.4-6.0 mg/dL', 60], ['Total Protein, Serum', 'Chemistry', '6.0-8.3 g/dL', 50], ['Albumin, Serum', 'Chemistry', '3.5-5.5 g/dL', 50], ['Globulin', 'Chemistry', '2.0-3.5 g/dL', 50], ['BMP - Basic Metabolic Panel', 'Chemistry', 'See components', 150], ['CMP - Comprehensive Metabolic Panel', 'Chemistry', 'See components', 200], ['Ammonia Level', 'Chemistry', '15-45 mcg/dL', 100], ['Lactate (Lactic Acid)', 'Chemistry', '0.5-2.2 mmol/L', 80], ['LDH - Lactate Dehydrogenase', 'Chemistry', '140-280 U/L', 70], ['CPK - Creatine Phosphokinase', 'Chemistry', 'M:39-308 F:26-192 U/L', 80], ['Amylase', 'Chemistry', '28-100 U/L', 80], ['Lipase', 'Chemistry', '0-160 U/L', 80],
        ['ALT (SGPT)', 'Liver Function', '7-56 U/L', 60], ['AST (SGOT)', 'Liver Function', '10-40 U/L', 60], ['ALP - Alkaline Phosphatase', 'Liver Function', '44-147 U/L', 60], ['GGT', 'Liver Function', 'M:9-48 F:9-36 U/L', 60], ['Total Bilirubin', 'Liver Function', '0.1-1.2 mg/dL', 60], ['Direct Bilirubin', 'Liver Function', '0.0-0.3 mg/dL', 60], ['Indirect Bilirubin', 'Liver Function', '0.1-0.9 mg/dL', 50], ['LFT - Liver Function Panel', 'Liver Function', 'See components', 150], ['Alpha-Fetoprotein (Liver)', 'Liver Function', '<10 ng/mL', 150],
        ['Total Cholesterol', 'Lipid Panel', '<200 mg/dL', 60], ['LDL Cholesterol', 'Lipid Panel', '<100 mg/dL optimal', 60], ['HDL Cholesterol', 'Lipid Panel', 'M:>40 F:>50 mg/dL', 60], ['Triglycerides', 'Lipid Panel', '<150 mg/dL', 60], ['VLDL Cholesterol', 'Lipid Panel', '5-40 mg/dL', 60], ['Lipid Panel (Complete)', 'Lipid Panel', 'See components', 120], ['Apolipoprotein B', 'Lipid Panel', '<90 mg/dL', 150], ['Lipoprotein(a)', 'Lipid Panel', '<30 mg/dL', 180],
        ['Sodium (Na)', 'Electrolytes', '136-145 mEq/L', 50], ['Potassium (K)', 'Electrolytes', '3.5-5.0 mEq/L', 50], ['Chloride (Cl)', 'Electrolytes', '98-106 mEq/L', 50], ['CO2 (Bicarbonate)', 'Electrolytes', '22-29 mEq/L', 50], ['Calcium, Total', 'Electrolytes', '8.6-10.2 mg/dL', 50], ['Calcium, Ionized', 'Electrolytes', '4.5-5.6 mg/dL', 80], ['Phosphorus', 'Electrolytes', '2.5-4.5 mg/dL', 50], ['Magnesium', 'Electrolytes', '1.7-2.2 mg/dL', 60], ['Zinc, Serum', 'Electrolytes', '60-120 mcg/dL', 100], ['Copper, Serum', 'Electrolytes', '70-140 mcg/dL', 100],
        ['TSH', 'Endocrinology', '0.27-4.20 mIU/L', 100], ['Free T4', 'Endocrinology', '0.93-1.70 ng/dL', 100], ['Free T3', 'Endocrinology', '2.0-4.4 pg/mL', 100], ['Total T4', 'Endocrinology', '4.5-12.0 mcg/dL', 80], ['Total T3', 'Endocrinology', '80-200 ng/dL', 80], ['Anti-TPO', 'Endocrinology', '<35 IU/mL', 120], ['Anti-Thyroglobulin Antibody', 'Endocrinology', '<40 IU/mL', 120], ['HbA1c', 'Endocrinology', '4.0-5.6%', 100], ['Fasting Insulin', 'Endocrinology', '2.6-24.9 mIU/L', 120], ['C-Peptide', 'Endocrinology', '1.1-4.4 ng/mL', 150], ['Cortisol, Morning', 'Endocrinology', '6.2-19.4 mcg/dL', 120], ['ACTH', 'Endocrinology', '7.2-63.3 pg/mL', 180], ['Aldosterone', 'Endocrinology', '<21 ng/dL upright', 180], ['PTH - Parathyroid Hormone', 'Endocrinology', '15-65 pg/mL', 150], ['Growth Hormone', 'Endocrinology', 'M:<5 F:<10 ng/mL', 180], ['IGF-1', 'Endocrinology', 'Age-dependent', 180], ['Prolactin', 'Endocrinology', 'M:4-15 F:4-23 ng/mL', 120], ['DHEA-S', 'Endocrinology', 'Age/sex-dependent', 120], ['Metanephrines, Plasma', 'Endocrinology', '<0.90 nmol/L', 250],
        ['CRP', 'Immunology', '<3.0 mg/L', 80], ['hs-CRP', 'Immunology', '<1.0 mg/L low risk', 100], ['RF - Rheumatoid Factor', 'Immunology', '<14 IU/mL', 80], ['Anti-CCP Antibodies', 'Immunology', '<20 U/mL', 150], ['ANA - Antinuclear Antibody', 'Immunology', 'Negative (<1:40)', 120], ['Anti-dsDNA', 'Immunology', '<30 IU/mL', 150], ['ENA Panel', 'Immunology', 'Negative', 250], ['Complement C3', 'Immunology', '90-180 mg/dL', 100], ['Complement C4', 'Immunology', '10-40 mg/dL', 100], ['IgG', 'Immunology', '700-1600 mg/dL', 100], ['IgA', 'Immunology', '70-400 mg/dL', 100], ['IgM', 'Immunology', '40-230 mg/dL', 100], ['IgE, Total', 'Immunology', '<100 IU/mL', 120], ['ANCA', 'Immunology', 'Negative', 200], ['ASO', 'Immunology', '<200 IU/mL', 80], ['SPEP', 'Immunology', 'See pattern', 200],
        ['Blood Culture, Aerobic', 'Microbiology', 'No growth', 150], ['Blood Culture, Anaerobic', 'Microbiology', 'No growth', 150], ['Urine Culture & Sensitivity', 'Microbiology', '<10,000 CFU/mL', 120], ['Wound Culture & Sensitivity', 'Microbiology', 'See report', 120], ['Throat Culture', 'Microbiology', 'Normal flora', 100], ['Sputum Culture', 'Microbiology', 'See report', 120], ['Stool Culture', 'Microbiology', 'No pathogen', 120], ['CSF Culture', 'Microbiology', 'No growth', 150], ['Fungal Culture', 'Microbiology', 'No growth', 150], ['AFB Culture (TB)', 'Microbiology', 'No growth', 200], ['AFB Smear', 'Microbiology', 'Negative', 80], ['Gram Stain', 'Microbiology', 'See report', 60], ['H. pylori Antigen, Stool', 'Microbiology', 'Negative', 120], ['H. pylori Antibody', 'Microbiology', 'Negative', 100], ['H. pylori Breath Test', 'Microbiology', 'Negative', 150], ['C. difficile Toxin', 'Microbiology', 'Negative', 150], ['MRSA Screen', 'Microbiology', 'Not detected', 150],
        ['Urinalysis, Complete', 'Urinalysis', 'See components', 60], ['Urine Dipstick', 'Urinalysis', 'See components', 40], ['Urine Microscopy', 'Urinalysis', 'See report', 50], ['Urine Albumin/Creatinine Ratio', 'Urinalysis', '<30 mg/g', 100], ['24-Hour Urine Protein', 'Urinalysis', '<150 mg/24hr', 100], ['24-Hour Creatinine Clearance', 'Urinalysis', 'M:97-137 F:88-128 mL/min', 120], ['Urine Drug Screen', 'Urinalysis', 'Negative', 150],
        ['Urine Drug Screen Panel', 'Toxicology', 'Negative', 200], ['Acetaminophen Level', 'Toxicology', '10-30 mcg/mL', 100], ['Ethanol Level', 'Toxicology', '0 mg/dL', 80], ['Digoxin Level', 'Toxicology', '0.8-2.0 ng/mL', 120], ['Lithium Level', 'Toxicology', '0.6-1.2 mEq/L', 100], ['Vancomycin Trough', 'Toxicology', '15-20 mcg/mL', 150], ['Tacrolimus Level', 'Toxicology', '5-15 ng/mL', 200], ['Lead Level, Blood', 'Toxicology', '<5 mcg/dL', 150],
        ['PSA', 'Tumor Markers', '<4.0 ng/mL', 120], ['AFP - Alpha-Fetoprotein', 'Tumor Markers', '<10 ng/mL', 150], ['CEA', 'Tumor Markers', '<3.0 ng/mL', 150], ['CA-125', 'Tumor Markers', '<35 U/mL', 150], ['CA 19-9', 'Tumor Markers', '<37 U/mL', 150], ['CA 15-3', 'Tumor Markers', '<30 U/mL', 150], ['Beta-hCG (Tumor Marker)', 'Tumor Markers', '<5 mIU/mL', 120], ['NSE', 'Tumor Markers', '<16.3 ng/mL', 180], ['Chromogranin A', 'Tumor Markers', '<93 ng/mL', 200], ['Calcitonin', 'Tumor Markers', 'M:<8.4 F:<5.0 pg/mL', 200],
        ['Blood Group & Rh Type', 'Blood Bank', 'A/B/AB/O, Rh+/-', 50], ['Antibody Screen', 'Blood Bank', 'Negative', 80], ['Crossmatch', 'Blood Bank', 'Compatible', 100], ['Direct Antiglobulin Test', 'Blood Bank', 'Negative', 80], ['Cold Agglutinins', 'Blood Bank', '<1:64', 120],
        ['Vitamin D, 25-Hydroxy', 'Vitamins', '30-100 ng/mL', 120], ['Vitamin B12', 'Vitamins', '200-900 pg/mL', 100], ['Folate, Serum', 'Vitamins', '>3.0 ng/mL', 80], ['Iron, Serum', 'Vitamins', 'M:60-170 F:40-150 mcg/dL', 60], ['TIBC', 'Vitamins', '250-400 mcg/dL', 60], ['Transferrin Saturation', 'Vitamins', '20-50%', 60], ['Ferritin', 'Vitamins', 'M:12-300 F:12-150 ng/mL', 80], ['Vitamin A', 'Vitamins', '30-65 mcg/dL', 150], ['Vitamin C', 'Vitamins', '0.2-2.0 mg/dL', 120], ['Vitamin E', 'Vitamins', '5.5-17.0 mg/L', 150], ['Vitamin B1 (Thiamine)', 'Vitamins', '70-180 nmol/L', 150], ['Vitamin B6', 'Vitamins', '5-50 mcg/L', 150],
        ['Troponin I', 'Cardiac Markers', '<0.04 ng/mL', 120], ['Troponin T, High Sensitivity', 'Cardiac Markers', '<14 ng/L', 150], ['BNP', 'Cardiac Markers', '<100 pg/mL', 150], ['NT-proBNP', 'Cardiac Markers', '<125 pg/mL', 180], ['CK-MB', 'Cardiac Markers', '<5.0 ng/mL', 100], ['Myoglobin', 'Cardiac Markers', '<90 ng/mL', 100], ['Homocysteine', 'Cardiac Markers', '5-15 umol/L', 120],
        ['Total IgE', 'Allergy', '<100 IU/mL', 100], ['Specific IgE - Dust Mite', 'Allergy', '<0.35 kU/L', 120], ['Specific IgE - Cat Dander', 'Allergy', '<0.35 kU/L', 120], ['Specific IgE - Grass Pollen', 'Allergy', '<0.35 kU/L', 120], ['Specific IgE - Milk', 'Allergy', '<0.35 kU/L', 120], ['Specific IgE - Egg White', 'Allergy', '<0.35 kU/L', 120], ['Specific IgE - Peanut', 'Allergy', '<0.35 kU/L', 120], ['Specific IgE - Wheat', 'Allergy', '<0.35 kU/L', 120], ['Food Allergy Panel (Top 8)', 'Allergy', 'See components', 400], ['Inhalant Allergy Panel', 'Allergy', 'See components', 400],
        ['Stool Analysis, Complete', 'Stool Analysis', 'See components', 80], ['Stool Occult Blood (FOBT)', 'Stool Analysis', 'Negative', 50], ['FIT - Fecal Immunochemical', 'Stool Analysis', 'Negative', 80], ['Stool Ova & Parasites', 'Stool Analysis', 'No parasites', 80], ['Fecal Calprotectin', 'Stool Analysis', '<50 mcg/g', 200], ['Fecal Elastase', 'Stool Analysis', '>200 mcg/g', 180],
        ['COVID-19 PCR', 'Molecular', 'Not detected', 200], ['COVID-19 Rapid Antigen', 'Molecular', 'Negative', 100], ['Influenza A/B PCR', 'Molecular', 'Not detected', 200], ['RSV PCR', 'Molecular', 'Not detected', 200], ['Respiratory Pathogen Panel', 'Molecular', 'See components', 500], ['TB QuantiFERON (IGRA)', 'Molecular', 'Negative', 250], ['Hepatitis B PCR (HBV DNA)', 'Molecular', 'Not detected', 300], ['Hepatitis C PCR (HCV RNA)', 'Molecular', 'Not detected', 300], ['HIV-1 RNA Viral Load', 'Molecular', 'Not detected', 350], ['CMV PCR', 'Molecular', 'Not detected', 250], ['EBV PCR', 'Molecular', 'Not detected', 250], ['HPV DNA Test', 'Molecular', 'Not detected', 200],
        ['CSF Analysis', 'Body Fluids', 'See components', 200], ['CSF Protein', 'Body Fluids', '15-45 mg/dL', 80], ['CSF Glucose', 'Body Fluids', '40-70 mg/dL', 60], ['CSF Cell Count', 'Body Fluids', '0-5 WBC/uL', 80], ['Pleural Fluid Analysis', 'Body Fluids', 'See components', 200], ['Synovial Fluid Analysis', 'Body Fluids', 'See components', 200], ['Ascitic Fluid Analysis', 'Body Fluids', 'See components', 200],
        ['Estradiol (E2)', 'Reproductive Hormones', 'Phase-dependent', 120], ['Progesterone', 'Reproductive Hormones', 'Phase-dependent', 120], ['Testosterone, Total', 'Reproductive Hormones', 'M:264-916 ng/dL', 120], ['Testosterone, Free', 'Reproductive Hormones', 'M:8.7-25.1 pg/mL', 150], ['FSH', 'Reproductive Hormones', 'Phase/sex-dependent', 120], ['LH', 'Reproductive Hormones', 'Phase/sex-dependent', 120], ['AMH', 'Reproductive Hormones', 'Age-dependent', 200], ['Beta-hCG (Pregnancy)', 'Reproductive Hormones', '<5 mIU/mL non-pregnant', 100], ['SHBG', 'Reproductive Hormones', 'M:10-57 F:18-114 nmol/L', 150],
        ['HBsAg', 'Infectious Disease', 'Negative', 80], ['HBsAb', 'Infectious Disease', '>10 mIU/mL immune', 80], ['HBcAb', 'Infectious Disease', 'Negative', 80], ['HCV Ab', 'Infectious Disease', 'Negative', 80], ['HIV 1/2 Ag/Ab Combo', 'Infectious Disease', 'Non-reactive', 100], ['RPR/VDRL (Syphilis)', 'Infectious Disease', 'Non-reactive', 60], ['FTA-ABS', 'Infectious Disease', 'Non-reactive', 100], ['Rubella IgG', 'Infectious Disease', '>10 IU/mL immune', 80], ['Rubella IgM', 'Infectious Disease', 'Negative', 80], ['CMV IgG', 'Infectious Disease', 'See interpretation', 80], ['CMV IgM', 'Infectious Disease', 'Negative', 80], ['Toxoplasma IgG', 'Infectious Disease', 'See interpretation', 80], ['Toxoplasma IgM', 'Infectious Disease', 'Negative', 80], ['EBV Panel', 'Infectious Disease', 'See interpretation', 200], ['Brucella Agglutination', 'Infectious Disease', '<1:80', 80], ['Widal Test (Typhoid)', 'Infectious Disease', '<1:80', 60], ['Dengue NS1 Antigen', 'Infectious Disease', 'Negative', 120], ['Malaria Smear', 'Infectious Disease', 'No parasites seen', 80], ['Malaria Rapid Test', 'Infectious Disease', 'Negative', 80], ['Mono Spot Test', 'Infectious Disease', 'Negative', 60], ['Varicella-Zoster IgG', 'Infectious Disease', 'See interpretation', 80], ['Measles IgG', 'Infectious Disease', 'See interpretation', 80],
        ['Anti-tTG IgA (Celiac)', 'Autoimmune', '<20 U/mL', 150], ['Anti-Endomysial Ab', 'Autoimmune', 'Negative', 200], ['Anti-GBM Antibodies', 'Autoimmune', '<20 U/mL', 200], ['Anti-Smooth Muscle Ab', 'Autoimmune', '<1:40', 150], ['Anti-Mitochondrial Ab', 'Autoimmune', 'Negative', 150], ['HLA-B27', 'Autoimmune', 'Negative/Positive', 200], ['Anti-Jo-1 Antibodies', 'Autoimmune', 'Negative', 150], ['Anti-Scl-70 Antibodies', 'Autoimmune', 'Negative', 150],
        ['ABG - Arterial Blood Gas', 'Blood Gas', 'See components', 100], ['pH, Arterial', 'Blood Gas', '7.35-7.45', 50], ['pCO2, Arterial', 'Blood Gas', '35-45 mmHg', 50], ['pO2, Arterial', 'Blood Gas', '80-100 mmHg', 50], ['HCO3, Arterial', 'Blood Gas', '22-26 mEq/L', 50], ['O2 Saturation, Arterial', 'Blood Gas', '95-100%', 40], ['VBG - Venous Blood Gas', 'Blood Gas', 'See components', 80],
    ];
    const client = await pool.connect();
    try {
        await client.query('BEGIN');
        for (const [n, c, r, p] of tests) {
            await client.query('INSERT INTO lab_tests_catalog (test_name,category,normal_range,price) VALUES ($1,$2,$3,$4)', [n, c, r, p]);
        }
        await client.query('COMMIT');
    } catch (e) { await client.query('ROLLBACK'); throw e; } finally { client.release(); }
    console.log(`  ✅ Lab catalog: ${tests.length} tests`);
}

async function populateRadiologyCatalog() {
    const r = await pool.query('SELECT COUNT(*) as cnt FROM radiology_catalog');
    if (parseInt(r.rows[0].cnt) > 0) return;
    const rads = [
        ['X-Ray', 'X-Ray Chest (PA)', '', 100], ['X-Ray', 'X-Ray Chest (Lateral)', '', 100], ['X-Ray', 'X-Ray Abdomen (KUB)', '', 100], ['X-Ray', 'X-Ray Abdomen (Erect)', '', 100], ['X-Ray', 'X-Ray Cervical Spine (AP/Lat)', '', 120], ['X-Ray', 'X-Ray Thoracic Spine', '', 120], ['X-Ray', 'X-Ray Lumbar Spine (AP/Lat)', '', 120], ['X-Ray', 'X-Ray Lumbosacral Spine', '', 120], ['X-Ray', 'X-Ray Pelvis (AP)', '', 100], ['X-Ray', 'X-Ray Hip (AP/Lat)', '', 100], ['X-Ray', 'X-Ray Shoulder', '', 100], ['X-Ray', 'X-Ray Elbow', '', 100], ['X-Ray', 'X-Ray Wrist', '', 100], ['X-Ray', 'X-Ray Hand', '', 100], ['X-Ray', 'X-Ray Fingers', '', 80], ['X-Ray', 'X-Ray Knee (AP/Lat)', '', 100], ['X-Ray', 'X-Ray Ankle', '', 100], ['X-Ray', 'X-Ray Foot', '', 100], ['X-Ray', 'X-Ray Toes', '', 80], ['X-Ray', 'X-Ray Skull (AP/Lat)', '', 120], ['X-Ray', 'X-Ray Facial Bones', '', 120], ['X-Ray', 'X-Ray Nasal Bones', '', 100], ['X-Ray', 'X-Ray Sinuses (Waters View)', '', 100], ['X-Ray', 'X-Ray Mandible', '', 100], ['X-Ray', 'X-Ray Panoramic (OPG)', '', 150], ['X-Ray', 'X-Ray Clavicle', '', 100], ['X-Ray', 'X-Ray Ribs', '', 100], ['X-Ray', 'X-Ray Sacrum/Coccyx', '', 100], ['X-Ray', 'X-Ray Both Knees (Standing)', '', 150], ['X-Ray', 'X-Ray Scapula', '', 100], ['X-Ray', 'X-Ray Forearm', '', 100], ['X-Ray', 'X-Ray Humerus', '', 100], ['X-Ray', 'X-Ray Femur', '', 100], ['X-Ray', 'X-Ray Tibia/Fibula', '', 100],
        ['CT', 'CT Brain (Non-contrast)', '', 500], ['CT', 'CT Brain (With Contrast)', '', 700], ['CT', 'CT Brain (With & Without Contrast)', '', 800], ['CT', 'CT Orbits', '', 500], ['CT', 'CT Sinuses', '', 400], ['CT', 'CT Temporal Bones', '', 500], ['CT', 'CT Neck', '', 500], ['CT', 'CT Chest (Non-contrast)', '', 500], ['CT', 'CT Chest (With Contrast)', '', 700], ['CT', 'CT Chest High Resolution (HRCT)', '', 600], ['CT', 'CT Abdomen (Non-contrast)', '', 500], ['CT', 'CT Abdomen (With Contrast)', '', 700], ['CT', 'CT Pelvis', '', 500], ['CT', 'CT Abdomen & Pelvis (With Contrast)', '', 800], ['CT', 'CT KUB (Renal Stone Protocol)', '', 500], ['CT', 'CT Cervical Spine', '', 500], ['CT', 'CT Thoracic Spine', '', 500], ['CT', 'CT Lumbar Spine', '', 500], ['CT', 'CT Angiography - Brain (CTA)', '', 900], ['CT', 'CT Angiography - Neck', '', 900], ['CT', 'CT Angiography - Chest (PE Protocol)', '', 900], ['CT', 'CT Angiography - Abdominal Aorta', '', 900], ['CT', 'CT Angiography - Lower Limbs', '', 900], ['CT', 'CT Angiography - Coronary (CCTA)', '', 1200], ['CT', 'CT Angiography - Renal', '', 900], ['CT', 'CT Enterography', '', 800], ['CT', 'CT Colonography (Virtual Colonoscopy)', '', 800], ['CT', 'CT Urography', '', 700], ['CT', 'CT Guided Biopsy', '', 1000], ['CT', 'CT 3D Reconstruction', '', 400],
        ['MRI', 'MRI Brain (Non-contrast)', '', 800], ['MRI', 'MRI Brain (With Contrast)', '', 1000], ['MRI', 'MRI Brain & MRA (Angiography)', '', 1200], ['MRI', 'MRI Orbits', '', 800], ['MRI', 'MRI Internal Auditory Canal (IAC)', '', 800], ['MRI', 'MRI Pituitary', '', 800], ['MRI', 'MRI Temporomandibular Joint (TMJ)', '', 800], ['MRI', 'MRI Neck', '', 800], ['MRI', 'MRI Cervical Spine', '', 800], ['MRI', 'MRI Thoracic Spine', '', 800], ['MRI', 'MRI Lumbar Spine', '', 800], ['MRI', 'MRI Whole Spine', '', 1500], ['MRI', 'MRI Sacroiliac Joints', '', 800], ['MRI', 'MRI Shoulder', '', 800], ['MRI', 'MRI Elbow', '', 800], ['MRI', 'MRI Wrist', '', 800], ['MRI', 'MRI Hand', '', 800], ['MRI', 'MRI Hip', '', 800], ['MRI', 'MRI Knee', '', 800], ['MRI', 'MRI Ankle', '', 800], ['MRI', 'MRI Foot', '', 800], ['MRI', 'MRI Abdomen', '', 900], ['MRI', 'MRI Pelvis', '', 900], ['MRI', 'MRI Liver (Hepatocyte-specific)', '', 1000], ['MRI', 'MRI MRCP (Biliary)', '', 1000], ['MRI', 'MRI Prostate (Multiparametric)', '', 1200], ['MRI', 'MRI Breast (Bilateral)', '', 1200], ['MRI', 'MRI Cardiac (CMR)', '', 1500], ['MRI', 'MRI Enterography', '', 1000], ['MRI', 'MRI Fetal', '', 1000], ['MRI', 'MRI Brachial Plexus', '', 800], ['MRI', 'MRA - Head (Intracranial)', '', 1000], ['MRI', 'MRA - Neck (Carotid)', '', 1000], ['MRI', 'MRA - Abdominal', '', 1000], ['MRI', 'MRA - Lower Limbs', '', 1000], ['MRI', 'MRV - Brain (Venography)', '', 1000],
        ['Ultrasound', 'US Abdomen (Complete)', '', 200], ['Ultrasound', 'US Abdomen (Limited)', '', 150], ['Ultrasound', 'US Pelvis (Transabdominal)', '', 200], ['Ultrasound', 'US Pelvis (Transvaginal)', '', 250], ['Ultrasound', 'US Thyroid', '', 200], ['Ultrasound', 'US Breast (Bilateral)', '', 250], ['Ultrasound', 'US Breast (Unilateral)', '', 200], ['Ultrasound', 'US Obstetric (1st Trimester)', '', 200], ['Ultrasound', 'US Obstetric (2nd/3rd Trimester)', '', 250], ['Ultrasound', 'US Obstetric (Growth Scan)', '', 300], ['Ultrasound', 'US Obstetric (Anomaly Scan - Level II)', '', 400], ['Ultrasound', 'US Renal', '', 200], ['Ultrasound', 'US Bladder (Pre/Post Void)', '', 200], ['Ultrasound', 'US Scrotal', '', 200], ['Ultrasound', 'US Soft Tissue', '', 150], ['Ultrasound', 'US Musculoskeletal', '', 200], ['Ultrasound', 'US Joint', '', 200], ['Ultrasound', 'US Neonatal Brain (Cranial)', '', 250], ['Ultrasound', 'US Hip (Infant)', '', 200], ['Ultrasound', 'US Guided Biopsy', '', 500], ['Ultrasound', 'US Guided Aspiration', '', 400], ['Ultrasound', 'Doppler - Carotid', '', 300], ['Ultrasound', 'Doppler - Lower Limb Arterial', '', 300], ['Ultrasound', 'Doppler - Lower Limb Venous (DVT)', '', 300], ['Ultrasound', 'Doppler - Upper Limb', '', 300], ['Ultrasound', 'Doppler - Renal', '', 300], ['Ultrasound', 'Doppler - Portal Vein/Hepatic', '', 300], ['Ultrasound', 'Doppler - Testicular', '', 250], ['Ultrasound', 'Doppler - Fetal', '', 300], ['Ultrasound', 'US Elastography (Liver)', '', 350],
        ['Mammography', 'Mammography (Screening - Bilateral)', '', 400], ['Mammography', 'Mammography (Diagnostic)', '', 450], ['Mammography', 'Tomosynthesis (3D Mammography)', '', 500], ['Mammography', 'Mammography with Spot Compression', '', 450], ['Mammography', 'Stereotactic Breast Biopsy', '', 1000],
        ['DEXA', 'DEXA Bone Densitometry (Spine & Hip)', '', 350], ['DEXA', 'DEXA Forearm', '', 250], ['DEXA', 'DEXA Whole Body Composition', '', 400],
        ['Echo', 'Echocardiography (TTE - Transthoracic)', '', 400], ['Echo', 'Echocardiography (TEE - Transesophageal)', '', 800], ['Echo', 'Stress Echocardiography', '', 600], ['Echo', 'Fetal Echocardiography', '', 500],
        ['Fluoroscopy', 'Barium Swallow', '', 300], ['Fluoroscopy', 'Barium Meal', '', 350], ['Fluoroscopy', 'Barium Enema', '', 400], ['Fluoroscopy', 'Small Bowel Follow Through', '', 350], ['Fluoroscopy', 'Voiding Cystourethrogram (VCUG)', '', 350], ['Fluoroscopy', 'Hysterosalpingography (HSG)', '', 500], ['Fluoroscopy', 'IVP/IVU (Intravenous Pyelogram)', '', 400], ['Fluoroscopy', 'Fistulography', '', 400], ['Fluoroscopy', 'Arthrography', '', 500],
        ['Nuclear Medicine', 'Bone Scan (Whole Body)', '', 600], ['Nuclear Medicine', 'Thyroid Scan & Uptake', '', 500], ['Nuclear Medicine', 'Renal Scan (DTPA/MAG3)', '', 500], ['Nuclear Medicine', 'DMSA Renal Scan', '', 500], ['Nuclear Medicine', 'Cardiac Perfusion Scan (SPECT)', '', 1000], ['Nuclear Medicine', 'Lung Perfusion/Ventilation Scan (V/Q)', '', 600], ['Nuclear Medicine', 'Hepatobiliary Scan (HIDA)', '', 600], ['Nuclear Medicine', 'GI Bleeding Scan', '', 600], ['Nuclear Medicine', 'Gastric Emptying Study', '', 500], ['Nuclear Medicine', 'Parathyroid Scan (Sestamibi)', '', 600], ['Nuclear Medicine', 'Sentinel Lymph Node Scan', '', 600], ['Nuclear Medicine', 'Gallium Scan', '', 700],
        ['PET/CT', 'PET/CT (FDG - Whole Body)', '', 3000], ['PET/CT', 'PET/CT (Brain)', '', 2500], ['PET/CT', 'PET/CT (Cardiac)', '', 2500],
        ['Interventional', 'Angiography (Diagnostic)', '', 2000], ['Interventional', 'Angioplasty', '', 5000], ['Interventional', 'Image-Guided Drainage', '', 1500], ['Interventional', 'Embolization', '', 5000], ['Interventional', 'Port-a-Cath Insertion', '', 3000], ['Interventional', 'PICC Line Insertion', '', 1500], ['Interventional', 'Nephrostomy', '', 2000], ['Interventional', 'Biliary Drainage (PTBD)', '', 3000], ['Interventional', 'Vertebroplasty', '', 5000], ['Interventional', 'Radiofrequency Ablation (RFA)', '', 5000], ['Interventional', 'TIPS Procedure', '', 8000], ['Interventional', 'Uterine Fibroid Embolization', '', 6000],
    ];
    const client = await pool.connect();
    try {
        await client.query('BEGIN');
        for (const [m, n, t, p] of rads) {
            await client.query('INSERT INTO radiology_catalog (modality,exact_name,default_template,price) VALUES ($1,$2,$3,$4)', [m, n, t, p]);
        }
        await client.query('COMMIT');
    } catch (e) { await client.query('ROLLBACK'); throw e; } finally { client.release(); }
    console.log(`  ✅ Radiology catalog: ${rads.length} exams`);
}

module.exports = { insertSampleData, populateLabCatalog, populateRadiologyCatalog };
